<p>I recently worked on a combo-box component that originally was set up to use the provided <code>selectedKey</code> prop value on first render, but then to manage the key internally using the <code>useState</code> hook.</p>
<p>Managing the state completely internally after first render worked fine when the prop value wasn’t expected to change after first render. For example, if a new page was completely loaded with a new prop, that was fine, but when the page content was changed due to a React Router navigation (which didn’t cause a complete rerender of all components like a vanilla browser refresh would) then problems set in.</p>
<p>Essentially, I had to set up the combo-box component so that the <code>selectedKey</code> would be managed <em>internally</em> unless the prop input for <code>selectedKey</code> changed, when it would then set its internal <code>selectedKey</code> value to the prop value.</p>
<p>At first I tried just <code>setSelectedKey</code> just in the raw body of the component, but that resulted in the value of the selected key being reset to the input prop even when the input hadn’t changed because components rerender when their parent rerenders (unless they’re memoized of course). </p>
<p>So I put the <code>setSelectedKey</code> in the component inside a <code>useEffect</code> that triggers when the input prop value changes, and voilà, problem solved!</p>
